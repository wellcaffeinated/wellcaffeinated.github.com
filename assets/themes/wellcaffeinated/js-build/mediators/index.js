define(["jquery","require","modules/overlay","tpl!templates/overlay-showcase.tpl","jquery.highlight","bootstrap-affix","bootstrap-typeahead"],function(e,t,n,r,i,s,o){function u(t){for(var n=0,r=arguments.length;n<r;n++){var i=arguments[n],s=e(i);if(s.scrollTop()>0)return i;s.scrollTop(1);var o=s.scrollTop()>0;s.scrollTop(0);if(o)return i}return t[t.length-1]}function a(e){var t=[],n;for(var r=0,i=e.length;r<i;++r)n=e[r],n&&t.push('<span class="title" data-url="'+encodeURIComponent(n.url)+'">'+n.title+"</span>"+(n.tags?'<span class="tags"><span class="tag">'+n.tags.join('</span><span class="tag">')+"</span></span>":""));return t}function l(t,n){f?n(f):e.getJSON("/search.json",function(e){f=a(e),n(f)})}var f;e(function(){e("#main").on({mouseenter:function(t){var n=e(this);if(!n.children("code").length)return;n.addClass("on").stop().animate({width:e("#container").innerWidth()-2*n.offset().left},300)},mouseleave:function(t){var n=e(this);if(!n.children("code").length)return;n.removeClass("on").stop().animate({width:n.parent().innerWidth()},300,function(){n.css("width","auto")})}},"pre"),e("#sidebar").on({click:function(t){t.preventDefault(),e(u("html","body")).animate({scrollTop:0},400)}},".backToTop a"),Modernizr.mq("only screen and (max-width: 767px)")&&Modernizr.localstorage&&(localStorage.wellcaff_visited&&localStorage.wellcaff_visited.length&&parseInt(localStorage.wellcaff_visited)>(new Date).getTime()?setTimeout(function(){e("body").animate({scrollTop:e("#container > .outer").offset().top},400)},500):localStorage.wellcaff_visited=""+((new Date).getTime()+864e5));var t=e("#nav-area");t.wrap(e("<div/>").css("height",t.outerHeight())).affix({offset:{top:function(){return e("#header").height()}}}),e("#search-box").typeahead({source:function(e,t){l(e,t)},updater:function(t){var n=e(t).filter(".title").data("url");n&&(n=unescape(n),window.location.pathname=n)},highlighter:function(t){var n=this.query,r=e("<div/>").html(t).highlight([n]).html();return r}}),e("#showcase-wrap").on("click",".item",function(t){var i=e(this),s=i.attr("id");n.open({content:{media:i.find(".media").html(),img:i.find(".thumb").attr("src"),description:i.find(".longtext").html()},template:r}),s&&(n.on("open",function(t,r){e(window).trigger("showcase-"+s,n.getElement()),n.off(r.type,r.handler)}),n.on("close",function(t,r){e(window).trigger("showcase-close-"+s,n.getElement()),n.off(r.type,r.handler)}))})})});